---
tags: ["课程","Games101","图形学"]
categories:
  - 图形学
  - Games101
  - 课程
series: ["课程"]
date: 2023-09-27
title: 12 几何（网格处理）、阴影图 
password: 211511011
message: 此文章转载请与作者处观看https://www.yuque.com/gaoshanliushui-mbfny
---
# 曲面细分

曲面细分是指将一个模型的面合理的分成更多小的面，从而提升模型精度，使模型越来越光滑，提高渲染效果。
![img](1695111141093-c31f397f-caec-4c03-b015-5e3ad68d1e6f.png)

## Loop细分

Loop细分是指Loop提出来的细分规则，只能针对于三角形。
![img](1695111141012-f38ffe77-16bc-4eeb-966f-6f9a1f22766e.png)



步骤：



1. 生成更多的顶点，组成新的三角形
   ![img](1695111141025-88d990e2-65d7-4544-9987-f177839d4080.png)
   如图，一个三角形被分成四个小三角形。
2. 调整这些顶点的位置
   把顶点分为两类：新生成的顶点和老的顶点。 

1. 1. 对新的顶点进行加权平均：
      ![img](1695111141123-4611d580-20c4-4e17-b3f9-cad59bb24c1f.png)
      其中白点是新的顶点
   2. 对老的顶点进行加权平均：
      ![img](1695111141356-bb8e5379-c95a-4e2e-a34c-84396ea42305.png)
      可以看出，老的顶点受到自己和相邻顶点度数的影响。

## Catmull-Clark细分

首先定义面和顶点类型：



- quad face：四边形面
- Non-quad face：非四边形面
- Extraordinary vertex ：奇异点(degree != 4，即度（点所连边数）不为4的点



细分步骤：
![img](1695111141873-0f891547-b3fd-427d-b3d2-3a99322901ed.png)
取每条边，每个面的中点并连起来。每个非四边形都引入了一个奇异点，非四边形面消失。



细分特点：



- 有几个非四边形面，就会多出几个奇异点，所以现在一共有2+2 = 4个
- 新多出来的奇异点的度数与原来所在面的边数相等，如这里就是3度
- 第一次细分之后所有面都会变成四边形，且往后奇异点数目不再增加



计算方法：
![img](1695111141889-faf3b44a-694e-4cc9-8263-dac4ca4af8c8.png)

# 曲面简化

曲面简化是指将一个模型的面合理的合成更少的面，从而降低模型精度，减小开销，如远处模型使用曲面简化。
![img](1695111142010-755cc1de-36bf-47c5-8d4e-977013041b91.png)



边塌陷：将一条边的两个顶点合成为一个顶点。
![img](1695111142172-893c9e43-b492-4fcc-be61-51a804e3fe94.png)
确定进行边塌陷的边通过二次度量误差。



二次误差度量：希望把这个点放到一个位置上，使得这个点到原来的几个面的距离平方和最小。
![img](1695111142317-18d65821-13b6-4bd8-a02a-2e05b761351f.png)
即蓝色新顶点所在的位置与原来各个平面的垂直距离之和。如果能够使得这个误差最小那么对整个模型样貌修改一定程度上也会较小。



曲面简化算法流程：



1. 为模型每条边赋值，其值为坍缩这条边之后，代替两个老顶点的新顶点所能得到的最小二次误差度量
2. 选取权值最小的边做坍缩，新顶点位置为原来计算得出使得二次误差最小的位置
3. 坍缩完之后，与之相连其他的边的位置会改动，更新这些边的权值
4. 重复上述步骤，直到到达终止条件



- 优先队列/堆
- 贪心算法，局部最优解而非全局最优解



（第12讲后面的shadow mapping放到了[09 着色（插值、高级纹理映射）](/https://www.yuque.com/gaoshanliushui-mbfny/sst4c5/gwoe13#4604ba29)中）